[{"/Users/victoriakrassova/Desktop/messanger-progect/server.ts":"1","/Users/victoriakrassova/Desktop/messanger-progect/src/core/block.ts":"2","/Users/victoriakrassova/Desktop/messanger-progect/src/app.ts":"3","/Users/victoriakrassova/Desktop/messanger-progect/src/components/button/index.tmpl.ts":"4","/Users/victoriakrassova/Desktop/messanger-progect/src/components/button/index.ts":"5","/Users/victoriakrassova/Desktop/messanger-progect/src/components/index.ts":"6","/Users/victoriakrassova/Desktop/messanger-progect/src/components/input/index.tmpl.ts":"7","/Users/victoriakrassova/Desktop/messanger-progect/src/components/input/index.ts":"8","/Users/victoriakrassova/Desktop/messanger-progect/src/core/event-bus.ts":"9","/Users/victoriakrassova/Desktop/messanger-progect/src/core/httpTransport.ts":"10","/Users/victoriakrassova/Desktop/messanger-progect/src/core/render-DOM.ts":"11","/Users/victoriakrassova/Desktop/messanger-progect/src/core/validation.ts":"12","/Users/victoriakrassova/Desktop/messanger-progect/src/pages/error/index.tmpl.ts":"13","/Users/victoriakrassova/Desktop/messanger-progect/src/pages/error/index.ts":"14","/Users/victoriakrassova/Desktop/messanger-progect/src/pages/index.ts":"15","/Users/victoriakrassova/Desktop/messanger-progect/src/pages/login/index.tmpl.ts":"16","/Users/victoriakrassova/Desktop/messanger-progect/src/pages/login/index.ts":"17","/Users/victoriakrassova/Desktop/messanger-progect/src/pages/registration/index.temp.ts":"18","/Users/victoriakrassova/Desktop/messanger-progect/src/pages/registration/index.ts":"19"},{"size":476,"mtime":1687088817115,"results":"20","hashOfConfig":"21"},{"size":5587,"mtime":1688408434555,"results":"22","hashOfConfig":"21"},{"size":792,"mtime":1688407245099,"results":"23","hashOfConfig":"21"},{"size":124,"mtime":1688065171185,"results":"24","hashOfConfig":"21"},{"size":438,"mtime":1688407389014,"results":"25","hashOfConfig":"21"},{"size":96,"mtime":1688065249834,"results":"26","hashOfConfig":"21"},{"size":277,"mtime":1688408338496,"results":"27","hashOfConfig":"21"},{"size":459,"mtime":1688407406665,"results":"28","hashOfConfig":"21"},{"size":1103,"mtime":1688408561689,"results":"29","hashOfConfig":"21"},{"size":1951,"mtime":1688065153038,"results":"30","hashOfConfig":"21"},{"size":246,"mtime":1688065144880,"results":"31","hashOfConfig":"21"},{"size":3179,"mtime":1688408525229,"results":"32","hashOfConfig":"21"},{"size":404,"mtime":1688407175569,"results":"33","hashOfConfig":"21"},{"size":340,"mtime":1688407167139,"results":"34","hashOfConfig":"21"},{"size":161,"mtime":1688407226357,"results":"35","hashOfConfig":"21"},{"size":408,"mtime":1688065204500,"results":"36","hashOfConfig":"21"},{"size":1391,"mtime":1688406872409,"results":"37","hashOfConfig":"21"},{"size":781,"mtime":1688407192354,"results":"38","hashOfConfig":"21"},{"size":2453,"mtime":1688408283919,"results":"39","hashOfConfig":"21"},{"filePath":"40","messages":"41","suppressedMessages":"42","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"181my1r",{"filePath":"43","messages":"44","suppressedMessages":"45","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"46"},{"filePath":"47","messages":"48","suppressedMessages":"49","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"50","messages":"51","suppressedMessages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"53","messages":"54","suppressedMessages":"55","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"56","messages":"57","suppressedMessages":"58","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"59","messages":"60","suppressedMessages":"61","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"62","messages":"63","suppressedMessages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"65","messages":"66","suppressedMessages":"67","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"68","messages":"69","suppressedMessages":"70","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"71"},{"filePath":"72","messages":"73","suppressedMessages":"74","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"75","messages":"76","suppressedMessages":"77","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"78","messages":"79","suppressedMessages":"80","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"81","messages":"82","suppressedMessages":"83","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"84","messages":"85","suppressedMessages":"86","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"87","messages":"88","suppressedMessages":"89","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"90","messages":"91","suppressedMessages":"92","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"93","messages":"94","suppressedMessages":"95","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"96","messages":"97","suppressedMessages":"98","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/victoriakrassova/Desktop/messanger-progect/server.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/core/block.ts",["99"],[],"import EventBus from './event-bus'\nimport Handlebars from 'handlebars'\nimport { v4 as makeUUID } from 'uuid'\n\nexport enum EVENTS {\n  INIT = 'init',\n  FLOW_CDM = 'flow:component-did-mount',\n  FLOW_CDU = 'flow:component-did-update',\n  FLOW_RENDER = 'flow:render',\n}\n\ntype Props = { [key: string]: unknown }\n\ntype MetaProps = {\n  tagName: string\n  props: Props\n}\n\nclass Block {\n  static EVENTS = {\n    INIT: 'init',\n    FLOW_CDM: 'flow:component-did-mount',\n    FLOW_CDU: 'flow:component-did-update',\n    FLOW_RENDER: 'flow:render',\n  } as const\n\n  private _element: HTMLElement | null = null\n  protected children: Record<string, Block>\n  private _meta: MetaProps\n  protected props: Props\n  public state: { [key: string]: unknown }\n  private eventBus: () => EventBus\n\n  public id: string = makeUUID()\n\n  constructor(tagName: string, propsAndChildren: Props) {\n    const { children, props } = this._getChildren(propsAndChildren)\n\n    this.children = children\n\n    const eventBus = new EventBus()\n\n    this._meta = {\n      tagName,\n      props,\n    }\n\n    this.props = this._makePropsProxy({ ...props, id: this.id })\n\n    this.eventBus = () => eventBus\n\n    this._registerEvents(eventBus)\n\n    this.state = {}\n\n    eventBus.emit(Block.EVENTS.INIT)\n  }\n\n  private _getChildren(propsAndChildren: Props) {\n    const children = {} as typeof this.children\n    const props = {} as Props\n\n    Object.entries(propsAndChildren).forEach(([key, value]): void => {\n      if (value instanceof Block) {\n        children[key as string] = value\n      } else {\n        props[key] = value\n      }\n    })\n\n    return { children, props }\n  }\n\n  protected compile(template: string, props: Props) {\n    const propsAndStubs = { ...props }\n\n    Object.entries(this.children).forEach(([key, child]) => {\n      propsAndStubs[key] = `<div data-id=\"${child.id}\"></div>`\n    })\n\n    const fragment = this._createDocumentElement('template') as HTMLTemplateElement\n\n    fragment.innerHTML = Handlebars.compile(template)(propsAndStubs)\n\n    Object.values(this.children).forEach((child) => {\n      const content = fragment.content\n      const stub = content.querySelector(`[data-id=\"${child.id}\"]`)\n\n      const el = child.getContent()\n\n      if (!stub) {\n        return\n      }\n\n      if (el) {\n        stub.replaceWith(el)\n      }\n    })\n\n    return fragment.content\n  }\n\n  private _registerEvents(eventBus: EventBus) {\n    eventBus.on(EVENTS.INIT, this.init.bind(this))\n    eventBus.on(EVENTS.FLOW_CDM, this._componentDidMount.bind(this))\n    eventBus.on(EVENTS.FLOW_CDU, this._componentDidUpdate.bind(this))\n    eventBus.on(EVENTS.FLOW_RENDER, this._render.bind(this))\n  }\n\n  private _createResources() {\n    this._element = this._createDocumentElement(this._meta?.tagName)\n  }\n\n  public init() {\n    this._createResources()\n\n    this.dispatchComponentDidMount()\n\n    this.eventBus().emit(Block.EVENTS.FLOW_RENDER)\n  }\n\n  private _componentDidMount(): void {\n    this.componentDidMount()\n  }\n\n  public componentDidMount(): void {}\n\n  public dispatchComponentDidMount(): void {\n    const { eventBus } = this\n    eventBus().emit(Block.EVENTS.FLOW_CDM)\n  }\n\n  private _componentDidUpdate(oldProps: Props, newProps: Props): void {\n    if (this.componentDidUpdate(oldProps, newProps)) {\n      this.eventBus().emit(EVENTS.FLOW_RENDER)\n    }\n  }\n\n  public componentDidUpdate(oldProps: Props, newProps: Props) {\n    return oldProps !== newProps\n  }\n\n  public setProps(nextProps: Props): void {\n    if (!nextProps) {\n      return\n    }\n\n    Object.assign(this.props, nextProps)\n  }\n\n  get element(): HTMLElement | null {\n    return this._element\n  }\n\n  private _render() {\n    const block = this.render()\n\n    this._removeEvents()\n\n    if (this._element) {\n      this._element.innerHTML = ''\n      this._element.appendChild(block)\n    }\n\n    this._addEvents()\n  }\n\n  // Переопределяется пользователем. Необходимо вернуть разметку\n  public render(): DocumentFragment {\n    return this.compile('', {})\n  }\n\n  public getContent(): HTMLElement | null {\n    return this.element\n  }\n\n  _makePropsProxy(props: Props) {\n    return new Proxy(props, {\n      get(target: Props, prop: string) {\n        const value = target[prop]\n        return typeof value === 'function' ? value.bind(target) : value\n      },\n      set: (target, p: string, value) => {\n        const oldValue = target[p]\n\n        if (oldValue !== value) {\n          target[p as keyof Props] = value\n          this.eventBus().emit(EVENTS.FLOW_CDU)\n        }\n\n        return true\n      },\n      deleteProperty: () => {\n        throw new Error('нет доступа')\n      },\n    })\n  }\n\n  private _createDocumentElement(tagName: string): HTMLElement {\n    const element = document.createElement(tagName)\n    element.setAttribute('data-id', this.id || '')\n\n    return element\n  }\n\n  private _addEvents(): void {\n    const { events = {} } = this.props\n\n    if (events) {\n      Object.entries(events as Record<string, () => void>).forEach(([eventName, callback]) => {\n        this._element?.addEventListener(eventName, callback)\n      })\n    }\n  }\n\n  private _removeEvents(): void {\n    const { events = {} } = this.props\n\n    if (events) {\n      Object.entries(events as Record<string, () => void>).forEach(([eventName, callback]) => {\n        this._element?.removeEventListener(eventName, callback)\n      })\n    }\n  }\n\n  public show(): void {\n    if (this._element) this._element.style.display = 'block'\n  }\n\n  public hide(): void {\n    if (this._element) this._element.style.display = 'none'\n  }\n}\n\nexport default Block\n","/Users/victoriakrassova/Desktop/messanger-progect/src/app.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/components/button/index.tmpl.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/components/button/index.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/components/index.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/components/input/index.tmpl.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/components/input/index.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/core/event-bus.ts",["100","101","102"],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/core/httpTransport.ts",["103"],[],"enum METHODS {\n  GET = 'GET',\n  POST = 'POST',\n  PUT = 'PUT',\n  DELETE = 'DELETE',\n}\n\ntype ObjectType = { [key: string]: any }\n\ntype HTTPMethod = (url: string, options?: ObjectType | undefined) => Promise<XMLHttpRequestUpload>\n\nfunction queryStringify(data: ObjectType) {\n  if (typeof data !== 'object') {\n    throw new Error('Data must be object')\n  }\n\n  const keys = Object.keys(data)\n  return keys.reduce((result, key, index) => {\n    return `${result}${key}=${data[key]}${index < keys.length - 1 ? '&' : ''}`\n  }, '?')\n}\n\nexport class HTTPTransport {\n  get: HTTPMethod = (url, options = {}) => {\n    return this.request(url + queryStringify(options.data), { ...options, method: METHODS.GET }, options.timeout)\n  }\n\n  put: HTTPMethod = (url, options = {}) => {\n    return this.request(url, { ...options, method: METHODS.PUT }, options.timeout)\n  }\n\n  post: HTTPMethod = (url, options = {}) => {\n    return this.request(url, { ...options, method: METHODS.POST }, options.timeout)\n  }\n\n  delete: HTTPMethod = (url, options = {}) => {\n    return this.request(url, { ...options, method: METHODS.DELETE }, options.timeout)\n  }\n\n  request = (url: string, options: ObjectType = {}, timeout = 5000): Promise<XMLHttpRequest> => {\n    const { headers = {}, method, data } = options\n\n    return new Promise(function (resolve, reject) {\n      if (!method) {\n        reject('No method')\n        return\n      }\n\n      const xhr = new XMLHttpRequest()\n      const isGet = method === METHODS.GET\n\n      xhr.open(method, isGet && !!data ? `${url}${queryStringify(data)}` : url)\n\n      Object.keys(headers).forEach((key) => {\n        xhr.setRequestHeader(key, headers[key])\n      })\n\n      xhr.onload = function () {\n        resolve(xhr)\n      }\n\n      xhr.onabort = reject\n      xhr.onerror = reject\n\n      xhr.timeout = timeout\n      xhr.ontimeout = reject\n\n      if (isGet || !data) {\n        xhr.send()\n      } else {\n        xhr.send(data)\n      }\n    })\n  }\n}\n","/Users/victoriakrassova/Desktop/messanger-progect/src/core/render-DOM.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/core/validation.ts",["104"],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/pages/error/index.tmpl.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/pages/error/index.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/pages/index.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/pages/login/index.tmpl.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/pages/login/index.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/pages/registration/index.temp.ts",[],[],"/Users/victoriakrassova/Desktop/messanger-progect/src/pages/registration/index.ts",[],[],{"ruleId":"105","severity":1,"message":"106","line":126,"column":36,"nodeType":"107","messageId":"108","endLine":126,"endColumn":38},{"ruleId":"109","severity":1,"message":"110","line":1,"column":24,"nodeType":"111","messageId":"112","endLine":1,"endColumn":27,"suggestions":"113"},{"ruleId":"109","severity":1,"message":"110","line":6,"column":40,"nodeType":"111","messageId":"112","endLine":6,"endColumn":43,"suggestions":"114"},{"ruleId":"109","severity":1,"message":"110","line":6,"column":64,"nodeType":"111","messageId":"112","endLine":6,"endColumn":67,"suggestions":"115"},{"ruleId":"109","severity":1,"message":"110","line":8,"column":36,"nodeType":"111","messageId":"112","endLine":8,"endColumn":39,"suggestions":"116"},{"ruleId":"109","severity":1,"message":"110","line":88,"column":41,"nodeType":"111","messageId":"112","endLine":88,"endColumn":44,"suggestions":"117"},"@typescript-eslint/no-empty-function","Unexpected empty method 'componentDidMount'.","FunctionExpression","unexpected","@typescript-eslint/no-explicit-any","Unexpected any. Specify a different type.","TSAnyKeyword","unexpectedAny",["118","119"],["120","121"],["122","123"],["124","125"],["126","127"],{"messageId":"128","fix":"129","desc":"130"},{"messageId":"131","fix":"132","desc":"133"},{"messageId":"128","fix":"134","desc":"130"},{"messageId":"131","fix":"135","desc":"133"},{"messageId":"128","fix":"136","desc":"130"},{"messageId":"131","fix":"137","desc":"133"},{"messageId":"128","fix":"138","desc":"130"},{"messageId":"131","fix":"139","desc":"133"},{"messageId":"128","fix":"140","desc":"130"},{"messageId":"131","fix":"141","desc":"133"},"suggestUnknown",{"range":"142","text":"143"},"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct.","suggestNever",{"range":"142","text":"144"},"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of.",{"range":"145","text":"143"},{"range":"145","text":"144"},{"range":"146","text":"143"},{"range":"146","text":"144"},{"range":"147","text":"143"},{"range":"147","text":"144"},{"range":"148","text":"143"},{"range":"148","text":"144"},[23,26],"unknown","never",[231,234],[255,258],[121,124],[2114,2117]]